<div class="container">
  <h2>Tickets</h2>

  <div class="mb-3">
    <a [routerLink]="['/tickets/create']" class="btn btn-primary"
      >Create New Ticket</a
    >
  </div>

  <div *ngIf="isLoading" class="text-center">
    <p>Loading tickets...</p>
  </div>

  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <div *ngIf="!isLoading && !error">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Title</th>
          <th>Status</th>
          <th>Priority</th>
          <th>Created</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let ticket of tickets">
          <td>{{ ticket.title }}</td>
          <td>
            <span
              [ngClass]="{
                'badge bg-warning': ticket.status === 'open',
                'badge bg-info': ticket.status === 'in-progress',
                'badge bg-success': ticket.status === 'resolved',
                'badge bg-secondary': ticket.status === 'closed'
              }"
              >{{ ticket.status }}</span
            >
          </td>

          <td>{{ ticket.createdAt | date : "short" }}</td>
          <td>
            <a
              [routerLink]="['/tickets', ticket.id]"
              class="btn btn-sm btn-info me-2"
              >View</a
            >
            <a
              [routerLink]="['/tickets', ticket.id, 'edit']"
              class="btn btn-sm btn-primary me-2"
              >Edit</a
            >
            <button
              *ngIf="isAdmin"
              (click)="deleteTicket(ticket.id)"
              class="btn btn-sm btn-danger"
            >
              Delete
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="tickets.length === 0" class="alert alert-info">
      No tickets found.
    </div>
  </div>
</div>
